<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Okolje Circle Envrionment - Spodbujevalno učenje</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Okolje Circle Envrionment";
        var mkdocs_page_input_path = "circ_env.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/python.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Spodbujevalno učenje
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Uvod</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../conda_env/">Priprava okolja</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Primer Cliff Walking</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cliff/">Primer okolja *Cliff Walking*</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cliff2/">Prikaz Q tabele</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cliff3/">Parametri učenja in eksploracija</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Primer Mountain Car</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../car/">MountainCar primer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../load_car/">Test agenta</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../car_reward/">Izpis nagrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../car_action/">Prikaz akcij glede na Q tabelo</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../car_DQN/">DQN</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../save_models/">Shranjevanje agentov in logiranje</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../carSB3Contrib/">Uporaba drugih algoritmov za učenje</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Primer Cart Pole</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cart/">Cartpole primer</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Circle Environment</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../circ_env_slo/">Okolje Circle Envrionment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../instalCircEnv/">Inštalacija paketa CircEnv</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../move_agent_mouse/">Premik agenta z miško</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../circ_env_tocka/">Premik v točko</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../circ_env_pak/">Dotik s pakom</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../circ_env_pak_rob/">Pomik paka v gol</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../circ_env_pak_gol/">Pomik paka v gol 2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../circ_env_pak_gol2/">Pomik paka v gol 3</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../circ_env_obj_gol/">Pomik naključnega objekta v gol</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../circ_env_train/">Učenje</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../circ_env_robot/">Povezovanje z robotom</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Hockey Environment</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../hockey_env/">Hockey Environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../hockey_help_snippets/">Funkcije za pomoč pri programiranju</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Spodbujevalno učenje</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Okolje Circle Envrionment</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="okolje-circle-envrionment">Okolje Circle Envrionment</h1>
<p>This Python code defines a custom environment for the OpenAI Gym toolkit. The environment is a rectangular, and an agent in the form of a circle can move within it. The agent is required to avoid colliding with the boundary of the world. The agent's movement and collision with the environment are simulated using the Pybox2D and Pygame libraries.</p>
<p>The environment is defined in a Python class named <code>CircleEnvironment</code> that inherits from the <code>gym.Env</code> class. The class defines several functions, including the <code>__init__()</code>, <code>reset()</code>, <code>step()</code>, <code>render()</code>, and <code>close()</code> functions, that are part of the OpenAI Gym environment API.</p>
<h2 id="libraries-used">Libraries Used</h2>
<p>The code imports the following libraries:</p>
<ul>
<li><strong><code>gym</code></strong>: an open-source toolkit for developing and comparing reinforcement learning algorithms. OpenAI Gym is a toolkit for developing and comparing reinforcement learning algorithms. It provides a set of environments for testing and training reinforcement learning agents, as well as standardized interfaces for interacting with those environments.</li>
<li><code>numpy</code>: a library for numerical computing with Python.</li>
<li><code>math</code>: a library for mathematical functions.</li>
<li><strong><code>pygame</code></strong>: a library for game development with Python. Pygame is a cross-platform set of Python modules designed for writing video games. It includes functionality to handle graphics, sound, input devices, and networking. Pygame can be used to create simple 2D games or more complex games with physics and AI.</li>
<li><strong><code>Box2D</code></strong>: a 2D physics engine for game development. Box2D is a 2D physics engine for simulations of physical systems. It can be used for simulations in games, robotics, computer vision, and other fields. It provides realistic simulation of collisions, forces, friction, and other physical interactions between objects in a 2D space.</li>
</ul>
<h2 id="variables-used">Variables Used</h2>
<p>The environment uses the following variables:</p>
<ul>
<li><code>PPM</code>: the number of pixels per meter used for rendering the environment.</li>
<li><code>TARGET_FPS</code>: the target frame rate used for rendering the environment.</li>
<li><code>TIME_STEP</code>: the length of each simulation time step.</li>
<li><code>WORLD_WIDTH</code>: the width of the circular world in simulation units [<em>m</em>].</li>
<li><code>WORLD_HEIGHT</code>: the height of the circular world in simulation units [<em>m</em>].</li>
<li><code>metadata</code>: a dictionary that contains metadata about the environment, including the available render modes and the target render frame rate.</li>
<li><code>contact_listener</code>: an instance of a custom contact listener class that is used to detect collisions between the agent and the environment.</li>
</ul>
<h2 id="standard-gym-functions-used">Standard <strong><code>gym</code></strong> functions Used</h2>
<p>The environment uses the following functions:</p>
<ul>
<li><code>__init__()</code>: the initialization function for the environment. It sets up the environment parameters, initializes the Pybox2D world, and sets the observation and action spaces.</li>
<li><code>_get_obs()</code>: a function that returns the current observation of the agent, which is its position within the world.</li>
<li><code>reset()</code>: a function that resets the environment to its initial state and returns the initial observation.</li>
<li><code>step()</code>: a function that takes an action as input, simulates the environment for one time step, and returns the new observation, reward, done flag, and optional information about the simulation.</li>
<li><code>render()</code>: a function that renders the environment using the specified render mode.</li>
<li><code>_render_frame()</code>: a function that renders a single frame of the environment.</li>
<li><code>close()</code>: a function that destroys the Pybox2D world and the agent, and closes the Pygame window.</li>
</ul>
<h2 id="custom-functions">Custom functions</h2>
<ul>
<li>
<p><code>_is_collision(object, goal)</code>: Checks if there is a collision between the body object and the body goal. It takes in two b2Body objects, object and goal, and returns a boolean indicating whether there is a collision. It can take any two <code>Box2D</code> b2Body objects to check collison between them and not just body object and the body goal.</p>
</li>
<li>
<p><code>create_agent(radius_px, friction)</code>: Creates a new b2Body object representing the agent. It takes in the radius of the agent in pixels, radius_px, and a friction value, friction, for the agent's fixtures.</p>
</li>
<li>
<p><code>create_puck(radius_px, friction, type)</code>: Creates a new b2Body object representing the puck. It takes in the radius of the puck in pixels, radius_px, a friction value, friction, for the puck's fixtures, and a string type that indicates whether the puck should be a dynamic object ('d') or a kinematic object ('k').</p>
</li>
<li>
<p><code>create_goal(dim_px, position)</code>: Creates a new b2Body object representing the goal. It takes in a tuple dim_px representing the dimensions of the goal in pixels, and a tuple position representing the position of the goal in the simulation.</p>
</li>
<li>
<p><code>create_circ_target(radius_px)</code>: Creates a new circular target. It takes in the radius of the target in pixels, radius_px.</p>
</li>
<li>
<p><code>create_random_object(radius_px)</code>: Creates a new random object with a random shape. It takes in the radius of the object in pixels, radius_px..</p>
</li>
<li>
<p><code>create_border()</code>: Creates the boundary of the simulation.</p>
</li>
<li>
<p><code>get_agent_position()</code>: Returns the current position of the agent as a numpy array.</p>
</li>
<li>
<p><code>get_puck_position()</code>: Returns the current position of the puck as a numpy array.</p>
</li>
<li>
<p><code>get_puck_velocity()</code>: Returns the current velocity of the puck as a numpy array.</p>
</li>
<li>
<p><code>get_target_position()</code>: Returns the current position of the target as a numpy array.</p>
</li>
<li>
<p><code>reset_agent(position)</code>: Resets the position and velocity of the agent to a specified position.</p>
</li>
<li>
<p><code>reset_puck(position)</code>: Resets the position and velocity of the puck to a specified position.</p>
</li>
<li>
<p><code>reset_target(position)</code>: Resets the position of the target to a specified position.</p>
</li>
<li>
<p><code>reset_random_object(position)</code>: Resets the position and velocity of the random object to a specified position.</p>
</li>
<li>
<p><code>set_agent_velocity(vel)</code>: This function sets the linear and angular velocity of the agent in the Box2D world. The input parameter vel is a tuple containing the x and y components of the velocity. The velocity is converted to a b2Vec2 object before being assigned to the agent.</p>
</li>
<li>
<p><code>set_puck_velocity(vel)</code>: This function sets the linear and angular velocity of the puck in the Box2D world. The input parameter vel is a tuple containing the x and y components of the velocity. The velocity is converted to a b2Vec2 object before being assigned to the puck.</p>
</li>
<li>
<p><code>draw_agent(color)</code>: This function draws the agent as a circle on the Pygame screen. The input parameter color is a tuple containing the RGB values of the color. The position of the agent is converted to Pygame coordinates before drawing.</p>
</li>
<li>
<p><code>draw_puck(color)</code>: This function draws the puck as a circle on the Pygame screen. The input parameter color is a tuple containing the RGB values of the color. The position of the puck is converted to Pygame coordinates before drawing.</p>
</li>
<li>
<p><code>draw_border(color)</code>: This function draws the border of the game as a rectangle on the Pygame screen. The input parameter color is a tuple containing the RGB values of the color.</p>
</li>
<li>
<p><code>draw_target(color)</code>: This function draws the target as a circle on the Pygame screen. The input parameter color is a tuple containing the RGB values of the color. The position of the target is converted to Pygame coordinates before drawing.</p>
</li>
<li>
<p><code>draw_goal(color)</code>: This function draws the goal as a polygon on the Pygame screen. The input parameter color is a tuple containing the RGB values of the color.</p>
</li>
<li>
<p><code>draw_random_object(color)</code>: This function draws a random object as a polygon on the Pygame screen. The input parameter color is a tuple containing the RGB values of the color. The position, angle and vertices of the object are converted to Pygame coordinates before drawing.</p>
</li>
<li>
<p><code>is_agent_outside_screen()</code>: This function checks if the agent is outside the screen or not. It returns True if the agent is outside the screen, otherwise it returns False.</p>
</li>
<li>
<p><code>calc_distance(pos1, pos2)</code>: This function calculates the Euclidean distance between two points. The input parameters pos1 and pos2 are tuples containing the x and y coordinates of the points.</p>
</li>
<li>
<p><code>unit_vector(pos1, pos2)</code>: This function calculates the unit vector pointing from pos1 to pos2. The input parameters pos1 and pos2 are tuples containing the x and y coordinates of the points. The function returns the unit vector as a numpy array.</p>
</li>
<li>
<p><code>calculate_scaled_component(pos_agent, pos_target, vel)</code>: This function calculates the scaled component of the velocity vector in the direction of the unit vector pointing from pos_agent to pos_target. The input parameters pos_agent and pos_target are tuples containing the x and y coordinates of the points. The input parameter vel is a tuple containing the x and y components of the velocity vector. The function returns the scaled component as a float value.</p>
</li>
</ul>
<h1 id="koda">Koda</h1>
<h2 id="premikanje-agenta-s-tipkovnico">Premikanje agenta s tipkovnico</h2>
<h3 id="ustvarimo-agenta-dolocimo-observation_space-in-action_space">Ustvarimo agenta, določimo <code>observation_space</code> in <code>action_space</code>.</h3>
<ul>
<li><code>__init__()</code>
<div class="language-py highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">observation_space</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">action_space</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">create_agent</span><span class="p">(</span><span class="n">agent_radius_px</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>        
</span></code></pre></div></li>
</ul>
<h3 id="potrebujemo-vsaj-en-podatek-za-observacijo">Potrebujemo vsaj en podatek za observacijo.</h3>
<ul>
<li><code>_get_obs()</code></li>
</ul>
<div class="language-py highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>        <span class="n">agent_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_agent_position</span><span class="p">()</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>        <span class="k">return</span> <span class="n">agent_pos</span>
</span></code></pre></div>
<h3 id="ponastavimo-agenta-v-reset-funkciji">Ponastavimo agenta v <code>reset()</code> funkciji.</h3>
<ul>
<li><code>reset()</code></li>
</ul>
<div class="language-py highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reset_agent</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agent_radius</span><span class="o">*</span><span class="mf">1.5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_radius</span><span class="o">*</span><span class="mf">1.5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agent_radius</span><span class="o">*</span><span class="mf">1.5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_radius</span><span class="o">*</span><span class="mf">1.5</span><span class="p">)))</span>
</span></code></pre></div>
<h3 id="naredimo-korak-v-step-funkciji">Naredimo korak v <code>step()</code> funkciji.</h3>
<ul>
<li><code>step()</code></li>
</ul>
<p>Premik agenta za <code>action</code></p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_agent_velocity</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</span></code></pre></div>
<p>Določimo <code>obs</code> spremenljivko.</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>        <span class="n">obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_obs</span><span class="p">()</span>
</span></code></pre></div>
<p>Določimo, <code>reward</code> in <code>done</code> spremenljivki. Za začetek inicializacija:</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>        <span class="n">reward</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>        <span class="n">done</span> <span class="o">=</span> <span class="kc">False</span> 
</span></code></pre></div>
<p>Nato lahko določimo osnovne pogoje:</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_step</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_steps</span><span class="p">:</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>            <span class="c1">#reward = -1.0</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>            <span class="n">done</span> <span class="o">=</span> <span class="kc">True</span>
</span></code></pre></div>
<h3 id="izrisemo-agenta">izrišemo agenta</h3>
<ul>
<li><code>_render_frame()</code></li>
</ul>
<div class="language-py highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_agent</span><span class="p">(</span><span class="n">green</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="na-koncu-izbrisemo-agenta-v-close-funkciji">Na koncu izbrišemo agenta v <code>close()</code> funkciji</h3>
<ul>
<li><code>close()</code></li>
</ul>
<div class="language-py highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">DestroyBody</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="zazenemo-okolje">Zaženemo okolje</h3>
<p>Zaženi skripto <code>playCirc.py</code></p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="go">python3 playCirc.py</span>
</span></code></pre></div>
<p>V skripti povečajte hitrost na <code>5</code>.</p>
<div class="language-py highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">playCirc.py</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-14">14</a></span>
<span class="normal"><a href="#__codelineno-10-15">15</a></span>
<span class="normal"><a href="#__codelineno-10-16">16</a></span>
<span class="normal"><a href="#__codelineno-10-17">17</a></span>
<span class="normal"><a href="#__codelineno-10-18">18</a></span>
<span class="normal"><a href="#__codelineno-10-19">19</a></span>
<span class="normal"><a href="#__codelineno-10-20">20</a></span>
<span class="normal"><a href="#__codelineno-10-21">21</a></span>
<span class="normal"><a href="#__codelineno-10-22">22</a></span>
<span class="normal"><a href="#__codelineno-10-23">23</a></span>
<span class="normal"><a href="#__codelineno-10-24">24</a></span>
<span class="normal"><a href="#__codelineno-10-25">25</a></span>
<span class="normal"><a href="#__codelineno-10-26">26</a></span>
<span class="normal"><a href="#__codelineno-10-27">27</a></span>
<span class="normal"><a href="#__codelineno-10-28">28</a></span>
<span class="normal"><a href="#__codelineno-10-29">29</a></span>
<span class="normal"><a href="#__codelineno-10-30">30</a></span>
<span class="normal"><a href="#__codelineno-10-31">31</a></span>
<span class="normal"><a href="#__codelineno-10-32">32</a></span>
<span class="normal"><a href="#__codelineno-10-33">33</a></span>
<span class="normal"><a href="#__codelineno-10-34">34</a></span>
<span class="normal"><a href="#__codelineno-10-35">35</a></span>
<span class="normal"><a href="#__codelineno-10-36">36</a></span>
<span class="normal"><a href="#__codelineno-10-37">37</a></span>
<span class="normal"><a href="#__codelineno-10-38">38</a></span>
<span class="normal"><a href="#__codelineno-10-39">39</a></span>
<span class="normal"><a href="#__codelineno-10-40">40</a></span>
<span class="normal"><a href="#__codelineno-10-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14"></a><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15"></a>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16"></a>    <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">()]):</span> <span class="k">break</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17"></a>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18"></a>    <span class="c1">#player controls</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19"></a>    <span class="n">keys</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_pressed</span><span class="p">()</span> 
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20"></a><span class="hll">    <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">]:</span> <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21"></a><span class="hll">    <span class="k">elif</span> <span class="n">keys</span><span class="p">[</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">]:</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22"></a>    <span class="k">else</span><span class="p">:</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23"></a><span class="hll">    <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_UP</span><span class="p">]:</span> <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24"></a><span class="hll">    <span class="k">elif</span> <span class="n">keys</span><span class="p">[</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_DOWN</span><span class="p">]:</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25"></a>    <span class="k">else</span><span class="p">:</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>   
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26"></a>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27"></a>    <span class="n">action</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28"></a>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29"></a>    <span class="c1">#action = env.action_space.sample()</span>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30"></a>    <span class="c1">#print(action)</span>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31"></a>    <span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32"></a>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33"></a>    <span class="c1"># Render the environment</span>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34"></a>    <span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35"></a>
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36"></a>    <span class="c1"># Check if the episode is finished</span>
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37"></a>    <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38"></a>        <span class="n">obs</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39"></a>
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40"></a><span class="c1"># Close the environment</span>
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41"></a><span class="n">env</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="dodajmo-osnovno-mejo">Dodajmo osnovno mejo</h3>
<ul>
<li><code>__init__()</code></li>
</ul>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">create_border</span><span class="p">()</span>    
</span></code></pre></div>
- <code>_render_frame()</code></p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_border</span><span class="p">(</span><span class="n">black</span><span class="p">)</span>
</span></code></pre></div>
<p>Zaključimo episodo, ko se agent dotakne meje.</p>
<ul>
<li><code>step()</code></li>
</ul>
<div class="language-py highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_collision</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">border</span><span class="p">):</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>            <span class="n">reward</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>            <span class="n">done</span> <span class="o">=</span> <span class="kc">True</span>  
</span></code></pre></div>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
