
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.1">
    
    
      
        <title>My Docs</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.402914a4.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spodbujevalno-ucenje" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="My Docs" class="md-header__button md-logo" aria-label="My Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            My Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Spodbujevalno učenje
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="My Docs" class="md-nav__button md-logo" aria-label="My Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    My Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="." class="md-nav__link md-nav__link--active">
        Spodbujevalno učenje
      </a>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="spodbujevalno-ucenje">Spodbujevalno učenje</h1>
<h1 id="strojno-ucenje">Strojno učenje</h1>
<p><img alt="alt text" src="images/Picture1.png" /></p>
<h1 id="spodbujevalno-ucenje_1">Spodbujevalno učenje</h1>
<ul>
<li>Učenje robotskih strategij v simuliranem okolju<ul>
<li>OpenAI Gym + Stable Baselines3 </li>
<li>Preprosta okolja</li>
<li>AirHockey</li>
</ul>
</li>
<li>Prenos na dejanskega robota</li>
<li>Vodene + samostojne vaje</li>
</ul>
<p><img alt="alt text" src="images/Picture2.png" /></p>
<ul>
<li>Okolje<ul>
<li>Stanje okolja</li>
<li>Nagrada ta agenta, za določeno stanje</li>
<li>Seznam možnih akcij</li>
</ul>
</li>
<li>Agent<ul>
<li>Strategija za izbiro najboljših akciji</li>
<li>Izvaja in se odloča o najboljši akciji</li>
</ul>
</li>
</ul>
<p><img alt="alt text" src="images/Picture3.png" /></p>
<p><img alt="alt text" src="images/Picture4.png" /></p>
<h2 id="okolje">Okolje</h2>
<ul>
<li>Spodbujevalno učenje zahteva veliko ponovitev<ul>
<li>Zelo nepraktično za razvoj na robotu</li>
<li>Učenje v simulaciji okolja -&gt; Env</li>
<li>Zbirka okolij -&gt; Gym</li>
</ul>
</li>
</ul>
<p>OpenAI Gym okolja za izvajanje spodbujevalnega učenja
(https://gym.openai.com/)</p>
<h2 id="programsko-okolje">Programsko okolje</h2>
<h3 id="openai-gym">OpenAI Gym</h3>
<ul>
<li>OpenAI Gym<ul>
<li>Simulacij različnih okolij</li>
<li>Pred pripravljena okolja</li>
<li>Struktura za razvoj lastnih okolij</li>
</ul>
</li>
</ul>
<p>(https://gymnasium.farama.org/environments/toy_text/cliff_walking/)</p>
<p>https://gymnasium.farama.org/environments/mujoco/</p>
<h3 id="stable-baselines3">Stable Baselines3</h3>
<ul>
<li>Knjižnica za algoritme za spodbujevalno učenje<ul>
<li>Globoko spodbujevalno učenje</li>
</ul>
</li>
<li>Stable Baselines3 (SB3) algoritmi za spodbujevalno učenje<ul>
<li>https://stable-baselines3.readthedocs.io/en/master/#</li>
<li>vsebuje še druga okolja v skladu s strukturo OpenAI Gym</li>
</ul>
</li>
</ul>
<p><img alt="alt text" src="images/Picture6.png" /></p>
<h3 id="priprava-python-okolja">Priprava python okolja</h3>
<ul>
<li>https://www.anaconda.com/</li>
<li>conda<ul>
<li>Ustvarjanje različnih okolij v katerih imate lahko inštalirane programske pakete za rezlične pakete
-Inštalacije so ločene med okolji in ne vplivajo drugo na drugo</li>
<li>Windowsi, Linux, ...</li>
</ul>
</li>
<li>Inštalacija po navodilih<ul>
<li>conda config --set auto_activate_base false</li>
</ul>
</li>
</ul>
<h4 id="ustvarjanje-okolja">Ustvarjanje okolja</h4>
<p><code>conda create --name rl_smpl_2 python=3.9</code></p>
<h4 id="aktivacija-okolja">Aktivacija okolja</h4>
<p><code>conda activate rl_smpl_2</code></p>
<h4 id="deaktivacija-okolja">Deaktivacija okolja</h4>
<p><code>conda deactivate</code></p>
<p>Četrtkova skupina
- conda okolje rl_cet</p>
<p>Petkova skupina
- conda okolje rl_pet</p>
<h1 id="q-ucenje">Q učenje</h1>
<p><img alt="alt text" src="images/Picture7.png" /></p>
<h2 id="primer-okolja-cliff-walking">Primer okolja <em>Cliff Walking</em></h2>
<p>https://gymnasium.farama.org/environments/toy_text/cliff_walking/</p>
<ol>
<li>
<p>Začnemo z novo python skripto</p>
</li>
<li>
<p>Uvoz potrebnih paketov</p>
</li>
</ol>
<pre><code class="language-python">import gym
import numpy as np
import random
from time import sleep
</code></pre>
<ol>
<li>
<p>Deklaracija okolja</p>
<ul>
<li>your_env = gym.make("YourEnv ", some_kwarg=your_vars)</li>
<li>
<p>your_env = gym.make("YourEnv")</p>
</li>
<li>
<p>Seznam okolij
    https://gymnasium.farama.org/environments/toy_text/</p>
</li>
</ul>
</li>
</ol>
<pre><code class="language-python">env = gym.make('CliffWalking-v0')
</code></pre>
<ol>
<li>Resetiramo in prikažemo okolje</li>
</ol>
<pre><code class="language-python">env.reset()
env.render()
</code></pre>
<ol>
<li>Prikažemo nekaj parametrov</li>
</ol>
<pre><code class="language-python">print( &quot;Observation space = &quot;, env.observation_space.n)
print( &quot;Actions = &quot;, env.action_space.n)
</code></pre>
<ol>
<li>Deklariramo Q tabelo</li>
</ol>
<pre><code class="language-python">q_table = np.zeros([env.observation_space.n, env.action_space.n])
#q_table = np.random.uniform(low=0, high=1, size=[env.observation_space.n, env.action_space.n])
print( &quot;Q table size = &quot;, q_table.shape)
</code></pre>
<ol>
<li>Deklariramo parametre</li>
</ol>
<pre><code class="language-python">learning_rate = 0.1
discount_factor = 0.95
epochs = 60000
epsilon = 1
START_EPSILON_DECAYING = 1
END_EPSILON_DECAYING = epochs//2
epsilon_decay_value = epsilon/(END_EPSILON_DECAYING - START_EPSILON_DECAYING)
SHOW_EVERY = 1000
</code></pre>
<ol>
<li>Začnemo z učenjem z izbranim številom epoh</li>
</ol>
<pre><code class="language-python">for episode in range(epochs):
    state = env.reset()
    done = False

    trial_length = 0
</code></pre>
<ol>
<li>Izvedemo posamezni „sprehod čez okolje“ z izbiro akcij<ul>
<li>raziskovanje: naključna akcija</li>
<li>uporabo zbranega znanja: akcija z maximalno q vrednostjo</li>
</ul>
</li>
</ol>
<pre><code class="language-python">    while not done:

        if (random.uniform(0, 1) &lt; epsilon): # Exploration with random action
            action = env.action_space.sample()
        else:                                # Use the action with the highest q-value
            action = np.argmax(q_table[state]) 
</code></pre>
<ol>
<li>Izvedemo akcijo v okolju in preberemo vrednosti novega stanja in nagrade</li>
</ol>
<pre><code class="language-python">        next_state, reward, done, info = env.step(action)
</code></pre>
<ol>
<li>Posodobimo stanje Q tabele</li>
</ol>
<pre><code class="language-python">        curr_q = q_table[state, action]
        next_max_q = np.max(q_table[next_state])
        new_q = (1 - learning_rate) * curr_q + learning_rate * (reward + discount_factor * next_max_q)
        q_table[state, action] = new_q
</code></pre>
<ol>
<li>Posodobimo stanje</li>
</ol>
<pre><code class="language-python">        state = next_state
</code></pre>
<ol>
<li>Shranimo dolžino trenutnega „sprehoda“</li>
</ol>
<pre><code class="language-python">        if episode % SHOW_EVERY == 0:
            trial_length += 1
</code></pre>
<ol>
<li>Celotna koda učenja do sedaj</li>
</ol>
<pre><code class="language-python">for episode in range(epochs):
    state = env.reset()
    done = False

    trial_length = 0


    while not done:
        if (random.uniform(0, 1) &lt; epsilon): # Exploration with random action
            action = env.action_space.sample()
        else: # Use the action with the highest q-value
            action = np.argmax(q_table[state]) 

        next_state, reward, done, info = env.step(action)

        curr_q = q_table[state, action]
        next_max_q = np.max(q_table[next_state])
        new_q = (1 - learning_rate) * curr_q + learning_rate * (reward + discount_factor * next_max_q)
        q_table[state, action] = new_q

        state = next_state

        if episode % SHOW_EVERY == 0:
            trial_length += 1

    if episode % SHOW_EVERY == 0:
        print(f'Episode: {episode:&gt;5d}, episode length: {int(trial_length):&gt;5d}')

    if END_EPSILON_DECAYING &gt;= episode &gt;= START_EPSILON_DECAYING:
        epsilon -= epsilon_decay_value
</code></pre>
<ol>
<li>Testiramo naučeno Q tabelo oziroma agenta</li>
<li>Resetiramo okolje in ga izrišemo</li>
</ol>
<pre><code class="language-python">print(q_table)

state = env.reset()
env.render()
   
done = False
trial_length = 0
</code></pre>
<ul>
<li>Izvedemo sprehod</li>
</ul>
<pre><code class="language-python">while not done:
    action = np.argmax(q_table[state])
    state, reward, done, info = env.step(action)
    trial_length += 1
    print(&quot; Step &quot; + str(trial_length))
    env.render()
    sleep(.2)
</code></pre>
<ol>
<li>Več testov, da vidimo uspešnost</li>
</ol>
<pre><code class="language-python">lengths=[]
for trialnum in range(1, 11):
    state = env.reset()
   
    done = False
    trial_length = 0
    
    while not done and trial_length &lt; 25:
        action = np.argmax(q_table[state])
        state, reward, done, info = env.step(action)
        print(&quot;Trial number &quot; + str(trialnum) + &quot; Step &quot; + str(trial_length))
        env.render()
        sleep(.2)
        trial_length += 1
    lengths.append(trial_length)
    
    sleep(.2)
avg_len=sum(lengths)/10
print(avg_len)
</code></pre>
<pre><code class="language-python">
</code></pre>
<pre><code class="language-python">
</code></pre>
<pre><code class="language-python">
</code></pre>
<pre><code class="language-python">
</code></pre>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": ".", "features": [], "search": "assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.b78d2936.min.js"></script>
      
    
  </body>
</html>