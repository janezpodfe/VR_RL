
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../car_action/">
      
      
        <link rel="next" href="../save_models/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.1">
    
    
      
        <title>DQN - Spodbujevalno učenje</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.402914a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ucenje-z-nevronskimi-mrezami-z-metodo-dqn" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Spodbujevalno učenje" class="md-header__button md-logo" aria-label="Spodbujevalno učenje" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Spodbujevalno učenje
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DQN
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Spodbujevalno učenje" class="md-nav__button md-logo" aria-label="Spodbujevalno učenje" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Spodbujevalno učenje
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Uvod
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../conda_env/" class="md-nav__link">
        Priprava okolja
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Primer Cliff Walking
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Primer Cliff Walking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cliff/" class="md-nav__link">
        Primer okolja *Cliff Walking*
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cliff2/" class="md-nav__link">
        Prikaz Q tabele
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cliff3/" class="md-nav__link">
        Parametri učenja in eksploracija
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Primer Mountain Car
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Primer Mountain Car
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../car/" class="md-nav__link">
        MountainCar primer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../load_car/" class="md-nav__link">
        Test agenta
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../car_reward/" class="md-nav__link">
        Izpis nagrade
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../car_action/" class="md-nav__link">
        Prikaz akcij glede na Q tabelo
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          DQN
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        DQN
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dqn" class="md-nav__link">
    DQN
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ppo" class="md-nav__link">
    PPO
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a2c" class="md-nav__link">
    A2C
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../save_models/" class="md-nav__link">
        Shranjevanje agentov in logiranje
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../carSB3Contrib/" class="md-nav__link">
        Uporaba drugih algoritmov za učenje
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Primer Cart Pole
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Primer Cart Pole
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cart/" class="md-nav__link">
        Cartpole primer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Circle Environment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Circle Environment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../circ_env_slo/" class="md-nav__link">
        Okolje Circle Envrionment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../playCirc_mouse/" class="md-nav__link">
        Skripta playCirc.py za premike z miško
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../move_agent_mouse/" class="md-nav__link">
        Premik agenta z miško
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../circ_env_tocka/" class="md-nav__link">
        Premik v točko
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../circ_env_pak/" class="md-nav__link">
        Dotik s pakom
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../circ_env_pak_tocka/" class="md-nav__link">
        Pomik paka v točko
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../circ_env_pak_gol/" class="md-nav__link">
        Pomik paka v gol
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../circ_env_obj_gol/" class="md-nav__link">
        Pomik naključnega objekta v gol
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../circ_env_train/" class="md-nav__link">
        Učenje
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dqn" class="md-nav__link">
    DQN
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ppo" class="md-nav__link">
    PPO
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a2c" class="md-nav__link">
    A2C
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="ucenje-z-nevronskimi-mrezami-z-metodo-dqn">Učenje z nevronskimi mrežami z metodo DQN</h1>
<p><img alt="alt text" src="https://spinningup.openai.com/en/latest/_images/rl_algorithms_9_15.svg" /></p>
<p><a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro2.html">https://spinningup.openai.com/en/latest/spinningup/rl_intro2.html</a></p>
<h2 id="dqn">DQN</h2>
<p>Q-učenje je algoritma za spodbujevalno učenje, ki uporablja tabelo za shranjevanje vrednosti Q za vsak par stanje-akcija. Ker pa prostor stanj postaja vse večji in kompleksnejši, postane shranjevanje vseh vrednosti Q v tabeli nepraktično. Tu pride na vrsto DQN.</p>
<p>DQN je vrsta algoritma za Q-učenje, ki za izračun (približka) vrednosti Q uporablja nevronsko mrežo. Nevronska mreža sprejme stanje kot vhod in kot izhod izračuna vrednosti Q za vsako možno akcijo. Mreža je naučena s kombinacijo ponovitve izkušenj in »target« nevronske mreže za izboljšanje stabilnosti in učinkovitosti.</p>
<blockquote>
<p>Tehnika ponovitve izkušenj se uporablja za izboljšanje učinkovitosti učenja. Namesto da bi nevronsko mrežo učili takoj na vsaki izkušnji, se izkušnje shranijo v spomin in se iz njega naključno izbere serija izkušenj za učenje mreže. To ima več prednosti. Prvič, pomaga prekiniti korelacijo med zaporednimi izkušnjami, kar lahko zmanjša verjetnost, da bo mreža obtičalo v lokalnem optimumu. Drugič, nevronski mreži omogoča, da se uči iz širšega razpona izkušenj, kar lahko privede do boljše posplošitve in boljšega delovanja.</p>
<p>»Target« nevronska mreža je ločena kopija glavnega nevronske mreže, ki se med učenjem uporablja za izračun ciljnih (»target«) vrednosti Q. V DQN uporabljamo »target« nevronsko mrežo za reševanje problema, znanega kot "problem premikajoče se tarče". Ta težava nastane, ko uporabimo isto omrežje za izračunavanje napovedi vrednosti Q in ciljnih vrednosti Q ter po vsaki napovedi posodobimo uteži nevronske mreže. To lahko povzroči hitro in nestanovitno spreminjanje ciljnih vrednosti Q, kar lahko privede do nestabilnosti v procesu učenja. Za rešitev te težave uporabimo »target« nevronsko mrežo, ki je kopija glavne nevronske mreže, vendar z zamrznjenimi parametri. »Target« nevronska mreža se uporablja za izračun ciljnih vrednosti Q, uteži glavnega omrežja pa se redno posodabljajo le z uporabo ciljnih vrednosti Q, ki jih izračuna ciljno omrežje. To stabilizira postopek učenja in omrežju omogoča učinkovitejše učenje.</p>
</blockquote>
<p>Najprej začnemo z vhodnim stanjem kor vhodom v nevronsko mrežo. Mreža nato vrne vrednosti Q za vsako možno akcijo. Podobno kot pri Q-učenju ne izberemo akcije z najvišjo vrednostjo Q. Namesto tega uporabimo tehniko, imenovano "epsilon-greedy exploration", kjer z verjetnostjo epsilon izberemo naključno akcijo in z verjetnostjo 1-epsilon izberemo akcijo z najvišjo vrednostjo Q. To algoritmu omogoča, da raziskuje nove akcije in potencialno najde boljše rešitve. Ko izberemo akcijo, jo izvedemo in opazujemo dobljeno nagrado in novo stanje. Ta izkušnja se shrani v spomin za ponovitev, ki ga bomo pozneje uporabili za učenje mreže.</p>
<p>Nato naključno izberemo serijo izkušenj iz spomina in jih uporabimo za učenje mreže. Vendar mreže ne želimo vedno znova učiti na istih izkušnjah, saj to lahko privede do pojava »overfitting«. Za rešitev te težave uporabimo »target« nevronsko mrežo, ki je kopija glavnega nevronske mreže, vendar z zamrznjenimi parametri. To »target« nevronsko mrežo uporabimo za izračun končnih vrednosti Q za vsako izkušnjo, nato pa posodobimo parametre glavne mreže, da čim bolj zmanjšamo razliko med napovedanimi vrednostmi Q in končnimi vrednostmi Q. Ta postopek se ponavlja iterativno, pri čemer nevronska mreža nenehno izboljšuje svoje ocene vrednosti Q, ko se uči iz izkušenj.</p>
<p>Če povzamemo, je DQN vrsta algoritma za Q-učenje, ki za oceno vrednosti Q uporablja nevronsko mrežo. Združuje ponovitev izkušenj in »target« nevronsko mrežo za izboljšanje stabilnosti in učinkovitosti. Z uporabo te metode lahko obravnavamo večje in bolj zapletene prostore stanj ter na koncu dosežemo boljše rezultate kot z Q-metodo.</p>
<h2 id="ppo">PPO</h2>
<p>DQN (Deep Q-Network) in PPO (Proximal Policy Optimization) sta priljubljeni metodi za spodbujevalno učenje, ki se uporabljata za učenje agentov za izvajanje določenih nalog. Vendar se razlikujeta glede na pristop in cilje. DQN je na vrednosti temelječa metoda spodbujevalnega učenja, ki uči vrednosti Q (pričakovane prihodnje nagrade) za vsak par stanje-akcija. Cilj DQN je naučiti se optimalno funkcijo Q, ki povezuje stanja z akcijami. To dosežemo z učenjem globoke nevronske mreže za oceno vrednosti Q z uporabo kombinacije ponovitve izkušenj in »target« nevronske mreže.</p>
<p>PPO pa je metoda spodbujevalnega učenja na podlagi strategije, ki se neposredno uči strategija za preslikavo iz stanj v akcije. Cilj PPO je maksimizirati pričakovano kumulativno nagrado agenta z iskanjem optimalne strategije. To se doseže z optimizacijo nadomestne objektivne funkcije, ki zagotavlja, da se nova strategija ne razlikuje preveč od stare.</p>
<p>Čeprav se lahko tako DQN kot PPO uporabljata za diskretne in zvezne prostore akcij, se razlikujeta po učinkovitosti vzorčenja, stabilnosti in enostavnosti izvajanja.</p>
<p>DQN je na splošno manj vzorčno učinkovit kot PPO, saj za učenje natančne funkcije Q potrebuje veliko število učnih vzorcev. Vendar je DQN znana po svoji stabilnosti in se uspešno uporablja v številnih aplikacijah, tudi v robotiki.</p>
<p>Po drugi strani pa je PPO znana po svoji učinkovitosti vzorčenja in je dokazano dosegla vrhunske rezultate pri številnih nalogah zveznega vodenja. PPO je tudi razmeroma enostavna za izvajanje, saj ne potrebuje ponovitve izkušenj ali ločene »target« nevronske mreže.</p>
<p>Čeprav sta DQN in PPO zmogljivi metodi učenja za spodbujevalno učenje, se razlikujeta po pristopu in ciljih. DQN je metoda, ki temelji na vrednosti in se uči optimalne funkcije Q, PPO pa je metoda, ki temelji na strategiji in se neposredno uči optimalne strategije. </p>
<h2 id="a2c">A2C</h2>
<p>A2C pa je metoda spodbujevalnega učenja, ki temelji na strategiji in se neposredno uči strategije (preslikava med stanji in akcijami). Cilj A2C je maksimizirati pričakovano kumulativno nagrado agenta z iskanjem optimalne strategije, podobno kot PPO. To se doseže s hkratnim učenjem dveh nevronskih mrež: »actor« nevronska mreža, ki aproksimira strategijo, in »critic« nevronske mreže, ki ocenjuje funkcijo vrednosti.</p>
<p>Ključna razlika med DQN in A2C je, da je DQN metoda »off-policy”, kar pomeni, da se uči optimalne vrednosti Q z uporabo ločene strategije, medtem ko je A2C metoda »on-policy”, kar pomeni, da se uči strategije in funkcije vrednosti neposredno iz trenutne strategije.</p>
<p>Druga razlika je, da se DQN lahko uporablja tako za diskretne kot za zvezne prostore akcij, medtem ko se A2C običajno uporablja za diskretne prostore akcij. Poleg tega je A2C na splošno bolj vzorčno učinkovita kot DQN, saj se lahko uči iz delnih trajektorij, medtem ko DQN za posodobitev svojih vrednosti Q potrebuje celotne trajektorije.</p>
<blockquote>
<p>Trajektorija $\tau$ je sekvenca parov $stanje_0$-&gt;$akcija_0$-&gt;$stanje_1$-&gt;$akcija_1$-&gt;...</p>
</blockquote>
<p>Ključna razlika med PPO in A2C je v tem, da PPO uporablja »clipped« objektivno funkcijo, da prepreči prevelike spremembe strategije ob vsaki posodobitvi, medtem ko A2C uporablja »advantage« funkcijo za oceno kakovosti vsake akcije glede na trenutno strategijo.</p>
<p>Druga razlika je, da je PPO na splošno bolj vzorčno učinkovit kot A2C, saj uporablja tehniko, imenovano vzorčenje po pomembnosti, za popravke posodobitev gradienta. Vzorčenje po pomembnosti omogoča, da se PPO uči iz stare strategije, kar lahko izboljša učinkovitost vzorčenja.</p>
<p>Čeprav sta tako PPO kot A2C učinkoviti metodi za spodbujevalno učenje, se razlikujeta po pristopu in ciljih. PPO je metoda, ki temelji na strategiji in se uči optimalne strategije z uporabo optimizacije in »clipped« objektivne funkcije, A2C pa je prav tako metoda, ki temelji na strategiji in se uči optimalne strategije in funkcije vrednosti z uporabo »advantage« funkcije prednosti. </p>
<blockquote>
<p>“Advantage” funkcija je temeljni koncept spodbujevalnega učenja, ki se uporablja za oceno kakovosti vsake akcije agenta glede na trenutno strategijo. Meri, koliko boljša je akcija v primerjavi s povprečno akcijo izvedeno na podlagi trenutne strategije, in se uporablja za posodabljanje strategije in funkcije vrednosti.</p>
<p>Bolj formalno je funkcija prednosti A(s, a) opredeljena kot razlika med vrednostjo Q (pričakovana kumulativna nagrada) za akcijo a v stanju s in funkcijo vrednosti (pričakovana kumulativna nagrada po trenutni strategiji) stanja s:</p>
<p>A(s, a) = Q(s, a) - V(s)</p>
<p>“Advantage” funkcija je pomemben gradnik številnih algoritmov spodbujevalnega učenja, kot sta A2C in PPO. Agentu omogoča razlikovanje med dobrimi in slabimi akcijami z izračunom pričakovanega izboljšanja dolgoročne nagrade za določeno akcijo v primerjavi s povprečno akcijo izvedeno na podlagi trenutne strategije. Ta informacija se uporabi za posodobitev strategije na način, ki agenta spodbuja k sprejemanju akcij, ki so boljša od povprečne akcije.</p>
<p>Eden od načinov za oceno funkcije prednosti je uporaba napake TD (napake časovne razlike) med ocenjeno funkcijo vrednosti in opazovano nagrado. To lahko storimo z metodo, imenovano enostopenjsko učenje TD (temporal difference), ki v vsakem časovnem koraku posodobi funkcijo vrednosti in “advantage” funkcijo. Drug pristop je uporaba natančnejše ocene “advantage” funkcije, kot je posplošena ocena prednosti (GAE), ki združuje več časovnih korakov, da zagotovi stabilnejšo oceno “advantage” funkcije.</p>
<p>“Advantage” funkcija je ključen gradnik algoritmov spodbujevalnega učenja, ki se uporablja za oceno kakovosti vsake akcije agenta. Agentu omogoča, da se nauči, katere akcije so boljše od drugih, ter ustrezno posodobi strategijo in funkcijo vrednosti.</p>
</blockquote>
<h1 id="prakticna-uporaba">Praktična uporaba</h1>
<ul>
<li>Učenje z nevronskimi mrežami z metodo DQN</li>
<li>Uporabimo python paket Stable Baselines3 (SB3)</li>
<li><a href="https://stable-baselines3.readthedocs.io/en/master/index.html">Stable-Baselines3 Docs</a></li>
<li>Stable Baselines3 omogoča celo vrsto drugih algoritmov<ul>
<li>A2C</li>
<li>PPO</li>
</ul>
</li>
<li>Razširitev SB3 Contrib<ul>
<li>dodatni sodobnejši algoritmi</li>
<li><a href="https://stable-baselines3.readthedocs.io/en/master/guide/sb3_contrib.html">SB3 Contrib dokumentacije</a></li>
<li><a href="https://github.com/Stable-Baselines-Team/stable-baselines3-contrib">Github repozitorij</a></li>
</ul>
</li>
</ul>
<p><img alt="alt text" src="../images/Picture8.png" /></p>
<p><img alt="alt text" src="../images/Picture9.png" /></p>
<h1 id="python-skripta-za-ucenje-agenta">Python skripta za učenje agenta</h1>
<ol>
<li>Nova python skripta</li>
<li>
<p>Incializacija okolja in učenja</p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">gym</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span> <span class="nn">stable_baselines3</span> <span class="kn">import</span> <span class="n">DQN</span> 
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;MountainCar-v0&quot;</span><span class="p">)</span>
</span></code></pre></div>
3. Preverimo prostor akcij in opazovanja</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;Actions = &quot;</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;Obs space high = &quot;</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">high</span><span class="p">)</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;Obs space low&quot;</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">low</span><span class="p">)</span>
</span></code></pre></div>
</li>
<li>
<p>Inicializiramo učenje agenta</p>
</li>
<li>
<p>Podatki za inicializacijo so na <a href="https://github.com/sgoodfriend/rl-algo-impls/blob/main/hyperparams/dqn.yml">spletni strani</a> ter na <a href="https://github.com/DLR-RM/rl-baselines3-zoo/tree/master/hyperparams">rl-baselines3-zoo</a></p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">policy_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">net_arch</span><span class="o">=</span><span class="p">[</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">])</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">DQN</span><span class="p">(</span><span class="s1">&#39;MlpPolicy&#39;</span><span class="p">,</span> 
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>            <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>            <span class="n">learning_rate</span><span class="o">=</span><span class="mf">4e-3</span><span class="p">,</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>            <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>            <span class="n">buffer_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>            <span class="n">learning_starts</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>            <span class="n">gamma</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>            <span class="n">target_update_interval</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>            <span class="n">train_freq</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>            <span class="n">gradient_steps</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>            <span class="n">exploration_fraction</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>            <span class="n">exploration_final_eps</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>            <span class="n">policy_kwargs</span><span class="o">=</span><span class="n">policy_kwargs</span><span class="p">,</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>            <span class="n">seed</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>            <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="p">)</span>
</span></code></pre></div>
</li>
<li>
<p>Učenje agenta</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">model</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">total_timesteps</span><span class="o">=</span><span class="mf">1.2e5</span><span class="p">)</span>
</span></code></pre></div>
</li>
<li>
<p>Shranimo model</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;dqn_car&quot;</span><span class="p">)</span>
</span></code></pre></div>
</li>
</ol>
<h1 id="python-skripta-za-testiranje-agenta">Python skripta za testiranje agenta</h1>
<ol>
<li>Nova python skripta</li>
<li>
<p>Incializacija okolja in učenja</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">import</span> <span class="nn">gym</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">from</span> <span class="nn">stable_baselines3</span> <span class="kn">import</span> <span class="n">DQN</span> 
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="kn">from</span> <span class="nn">stable_baselines3.common.evaluation</span> <span class="kn">import</span> <span class="n">evaluate_policy</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;MountainCar-v0&quot;</span><span class="p">)</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;Actions = &quot;</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;Obs space high = &quot;</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">high</span><span class="p">)</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;Obs space low&quot;</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">low</span><span class="p">)</span>
</span></code></pre></div>
</li>
<li>
<p>Naložimo in incializiramo agenta</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">DQN</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dqn_car&quot;</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">)</span>
</span></code></pre></div>
</li>
<li>
<p>Zaženemo in testiramo agenta</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">mean_reward</span><span class="p">,</span> <span class="n">std_reward</span> <span class="o">=</span> <span class="n">evaluate_policy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">get_env</span><span class="p">(),</span> <span class="n">n_eval_episodes</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean reward: </span><span class="si">{</span><span class="n">mean_reward</span><span class="si">}</span><span class="s1">, Std reward: </span><span class="si">{</span><span class="n">std_reward</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="n">obs</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>    <span class="n">action</span><span class="p">,</span> <span class="n">_state</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">deterministic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>    <span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>    <span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>    <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>        <span class="n">obs</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</span></code></pre></div>
</li>
</ol>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.b78d2936.min.js"></script>
      
    
  </body>
</html>